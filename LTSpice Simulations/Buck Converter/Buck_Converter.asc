Version 4
SHEET 1 5444 1436
WIRE -1072 -160 -1184 -160
WIRE -992 -160 -1072 -160
WIRE -768 -160 -992 -160
WIRE -496 -160 -528 -160
WIRE -448 -160 -496 -160
WIRE -192 -160 -352 -160
WIRE -112 -160 -192 -160
WIRE -32 -160 -112 -160
WIRE 160 -160 48 -160
WIRE 256 -160 160 -160
WIRE 368 -160 256 -160
WIRE -992 -128 -992 -160
WIRE -768 -128 -768 -160
WIRE -448 -96 -448 -160
WIRE -352 -96 -352 -160
WIRE 368 -64 368 -160
WIRE -112 -48 -112 -160
WIRE 160 -48 160 -160
WIRE -1344 -32 -1376 -32
WIRE -1280 -32 -1344 -32
WIRE -1376 0 -1376 -32
WIRE -432 0 -480 0
WIRE -368 0 -368 -48
WIRE -368 0 -432 0
WIRE -768 32 -768 -48
WIRE -992 64 -992 -48
WIRE -896 64 -992 64
WIRE -768 80 -768 32
WIRE -768 80 -832 80
WIRE -896 96 -944 96
WIRE -112 112 -112 16
WIRE 160 112 160 16
WIRE 368 112 368 16
WIRE -1376 128 -1376 80
WIRE -992 128 -992 64
WIRE -1312 192 -1376 192
WIRE -1120 192 -1312 192
WIRE -992 208 -992 128
WIRE -992 208 -1056 208
WIRE -1120 224 -1184 224
WIRE -1376 240 -1376 192
WIRE -1184 304 -1184 224
WIRE -944 304 -944 96
WIRE -1376 384 -1376 320
WIRE -496 448 -528 448
WIRE -448 448 -496 448
WIRE -192 448 -352 448
WIRE -112 448 -192 448
WIRE -32 448 -112 448
WIRE 160 448 48 448
WIRE 256 448 160 448
WIRE 368 448 256 448
WIRE -448 512 -448 448
WIRE -352 512 -352 448
WIRE 368 544 368 448
WIRE -112 560 -112 448
WIRE 160 560 160 448
WIRE -432 608 -480 608
WIRE -368 608 -368 560
WIRE -368 608 -432 608
WIRE -112 720 -112 624
WIRE 160 720 160 624
WIRE 368 720 368 624
FLAG -112 720 0
FLAG -432 608 PWM1
FLAG -1312 192 MCU_PWM
FLAG -1344 -32 Vin
FLAG 256 448 Vout1
FLAG -192 448 Sw1
FLAG -1376 384 0
FLAG -1184 304 0
FLAG -1072 -160 Vin
FLAG -768 32 PWM2
FLAG -1376 128 0
FLAG -496 448 Vin
FLAG 160 720 0
FLAG 368 720 0
FLAG -112 112 0
FLAG -432 0 PWM2
FLAG 256 -160 Vout2
FLAG -192 -160 Sw2
FLAG -496 -160 Vin
FLAG 160 112 0
FLAG 368 112 0
FLAG -992 128 PWM1
FLAG -944 304 0
SYMBOL schottky -96 624 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value MBR20100CT
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage -1376 -16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL ind -48 464 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 1m
SYMBOL cap 144 560 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL res 352 528 R0
SYMATTR InstName R1
SYMATTR Value 50
SYMBOL voltage -1376 224 R0
WINDOW 3 -71 188 VLeft 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 5 0 1n 1n {D*100u} 100u)
SYMATTR InstName V2
SYMBOL nmos -448 560 R270
SYMATTR InstName M1
SYMATTR Value IRLHM630
SYMBOL res -1008 -144 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res -784 -144 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL schottky -96 16 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value MBR20100CT
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL ind -48 -144 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 1m
SYMBOL cap 144 -48 R0
SYMATTR InstName C2
SYMATTR Value 100µ
SYMBOL res 352 -80 R0
SYMATTR InstName R4
SYMATTR Value 50
SYMBOL nmos -448 -48 R270
SYMATTR InstName M4
SYMATTR Value IRLHM630
SYMBOL AutoGenerated\\BSS138_ZTX -864 80 M0
SYMATTR InstName U1
SYMBOL AutoGenerated\\BSS138_ZTX -1088 208 M0
SYMATTR InstName U2
TEXT -1120 448 Left 2 !.tran 0.1
TEXT -440 -344 Left 2 !.inc rb160lam-90_ltspice.lib
TEXT -440 -368 Left 2 !.inc stp55nf06.lib
TEXT -128 -264 Left 2 ;Inductor value can't be too high\nor less PWM has constant Vout.
TEXT -80 -32 Left 2 ;Diode does matter \n(for some reason)
TEXT -1120 416 Left 2 !.param D=0.08
TEXT -1312 -248 Left 2 ;PWM1 is not of the MCU input, so D1 = 1-D.\nPWM2 follows MCU input, so D2 = D..
TEXT 440 -104 Left 2 ;Need to test it at various loads:\n- No load\n- 1Ohm\n- 100 Ohm\n- 1kOhm\n- 10kOhm\n- 100kOhm
TEXT 440 544 Left 2 ;Testing if it's worthwhile having a 2nd buck\nconverter with the not logic for better efficiency.
